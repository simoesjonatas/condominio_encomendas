{% extends "base.html" %}

{% block title %}Encomendas Pendentes{% endblock %}

{% block content %}

<h3 class="mb-3">
    <i class="bi bi-stack"></i> Encomendas Pendentes
</h3>

{% if encomendas %}

    {% comment %} <form method="post" action="{% url 'imprimir_etiquetas_lote' %}" target="_blank">
        {% csrf_token %}

        <button class="btn btn-secondary mb-3">
            <i class="bi bi-printer"></i> Imprimir Etiquetas Selecionadas
        </button>

        <div class="list-group">
            {% for e in encomendas %}
            <label class="list-group-item d-flex align-items-center gap-2">

                <input type="checkbox" name="ids" value="{{ e.id }}">

                <div class="flex-grow-1">
                    <strong>Bloco {{ e.apartamento.bloco.nome }} · Apto {{ e.apartamento.numero }}</strong>
                    <br>
                    <small class="text-muted">#{{ e.sequencial_do_dia }} — {{ e.morador }}</small>
                </div>

                <a href="{% url 'detalhes_encomenda' e.pk %}" class="btn btn-sm btn-outline-primary">
                    Detalhes
                </a>

            </label>
            {% endfor %}
        </div>
    </form> {% endcomment %}




    <div class="list-group">

        {% for e in encomendas %}
            <div class="list-group-item list-group-item-action mb-2 shadow-sm rounded">

                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="mb-1 fw-bold">
                        Bloco {{ e.morador.bloco }} · Apto {{ e.morador.apartamento }}
                    </h5>

                    <span class="badge bg-primary">
                        #{{ e.sequencial_do_dia }}
                    </span>
                </div>

                <p class="mb-1 text-muted">
                    Morador: <strong>{{ e.morador.nome }}</strong><br>
                    Recebido em: {{ e.data_recebimento }}
                </p>

                {% if e.descricao %}
                    <p class="text-muted small">Pacote: {{ e.descricao }}</p>
                {% endif %}

                <div class="mt-3 d-flex gap-2">
                    <a href="{% url 'entregar_encomenda' e.pk %}" class="btn btn-success w-100">
                        <i class="bi bi-pencil"></i> Registrar Entrega
                    </a>

                    <a href="{% url 'detalhes_encomenda' e.pk %}" class="btn btn-outline-primary btn-sm w-100">
                        <i class="bi bi-search"></i> Detalhes
                    </a>

                </div>

            </div>
        {% endfor %}

    </div>
{% else %}
    <div class="alert alert-info">
        Nenhuma encomenda pendente no momento.
    </div>
{% endif %}

{% endblock %}
